<div class="version-history-container">
  <!-- Header -->
  <div class="version-history-header">
    <h5 class="mb-0">
      <i class="ri-history-line me-2"></i>Version History
    </h5>
    <button class="btn btn-sm btn-icon" (click)="onClose()">
      <i class="ri-close-line"></i>
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading version history...</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && versions.length === 0">
    <i class="ri-history-line empty-icon"></i>
    <p class="empty-text">No version history available</p>
  </div>

  <!-- Version List -->
  <div class="version-list" *ngIf="!loading && versions.length > 0">
    <div class="version-item card"
         *ngFor="let version of versions; let first = first"
         [class.current-version]="version.versionNumber === currentVersionNumber"
         [class.first-version]="first">
      <div class="version-header">
        <div class="version-badge-container">
          <span class="version-number badge bg-primary">v{{ version.versionNumber }}</span>
          <span class="current-label badge bg-success ms-2" *ngIf="version.versionNumber === currentVersionNumber">
            <i class="ri-check-line me-1"></i>CURRENT
          </span>
          <span class="manual-badge badge bg-info-subtle text-info ms-2" *ngIf="version.createdByUser">
            <i class="ri-user-line me-1"></i>Manual
          </span>
        </div>
        <div class="transformation-type">
          <span class="badge" [ngClass]="{
            'bg-primary-subtle text-primary': version.transformationType === 'INITIAL_GENERATION',
            'bg-info-subtle text-info': version.transformationType === 'SIMPLIFY' || version.transformationType === 'CONDENSE',
            'bg-success-subtle text-success': version.transformationType === 'EXPAND',
            'bg-warning-subtle text-warning': version.transformationType === 'REDRAFT',
            'bg-secondary-subtle text-secondary': version.transformationType === 'MANUAL_EDIT',
            'bg-danger-subtle text-danger': version.transformationType === 'RESTORE_VERSION'
          }">
            {{ getTransformationLabel(version.transformationType) }}
          </span>
        </div>
      </div>

      <div class="version-body">
        <div class="version-meta">
          <span class="meta-item">
            <i class="ri-time-line me-1 text-muted"></i>
            <strong>{{ getRelativeTime(version.createdAt) }}</strong>
          </span>
          <span class="meta-item">
            <i class="ri-file-text-line me-1 text-muted"></i>
            <strong>{{ version.wordCount }}</strong> words
          </span>
          <span class="meta-item" *ngIf="version.tokensUsed">
            <i class="ri-cpu-line me-1 text-muted"></i>
            <strong>{{version.tokensUsed}}</strong> tokens
          </span>
        </div>

        <div class="version-note alert alert-info py-2 px-3 mb-0 mt-2" *ngIf="version.versionNote">
          <i class="ri-sticky-note-line me-2"></i>
          <em>{{ version.versionNote }}</em>
        </div>
      </div>

      <div class="version-actions">
        <button class="btn btn-sm btn-outline-primary"
                (click)="onPreview(version)"
                title="Preview this version">
          <i class="ri-eye-line me-1"></i>
          View
        </button>
        <button class="btn btn-sm btn-outline-success"
                (click)="onRestore(version)"
                *ngIf="version.versionNumber !== currentVersionNumber"
                title="Restore this version">
          <i class="ri-refresh-line me-1"></i>
          Restore
        </button>
      </div>
    </div>
  </div>
</div>
