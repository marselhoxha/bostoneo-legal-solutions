<div class="container-fluid">
  <!-- Page Header -->
  <div class="row">
    <div class="col-12">
      <div class="page-title-box d-sm-flex align-items-center justify-content-between">
        <h4 class="mb-sm-0 font-size-18">ðŸ¤– AI Legal Assistant</h4>
        <div class="page-title-right">
          <ol class="breadcrumb m-0">
            <li class="breadcrumb-item"><a href="javascript: void(0);">Legal</a></li>
            <li class="breadcrumb-item active">AI Assistant</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="row">
    <div class="col-xl-3 col-md-6">
      <div class="card mini-stats-wid">
        <div class="card-body">
          <div class="d-flex">
            <div class="flex-grow-1">
              <p class="text-muted fw-medium">Documents Generated</p>
              <h4 class="mb-0">{{dashboardStats.documentsGenerated | number}}</h4>
            </div>
            <div class="avatar-sm rounded-circle bg-primary align-self-center mini-stat-icon">
              <span class="avatar-title rounded-circle bg-primary">
                <i class="ri-file-text-line font-size-24"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card mini-stats-wid">
        <div class="card-body">
          <div class="d-flex">
            <div class="flex-grow-1">
              <p class="text-muted fw-medium">Time Saved</p>
              <h4 class="mb-0">{{dashboardStats.timeSaved | number}} hrs</h4>
            </div>
            <div class="avatar-sm rounded-circle bg-success align-self-center mini-stat-icon">
              <span class="avatar-title rounded-circle bg-success">
                <i class="ri-time-line font-size-24"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card mini-stats-wid">
        <div class="card-body">
          <div class="d-flex">
            <div class="flex-grow-1">
              <p class="text-muted fw-medium">Active Sessions</p>
              <h4 class="mb-0">{{dashboardStats.activeSessions}}</h4>
            </div>
            <div class="avatar-sm rounded-circle bg-info align-self-center mini-stat-icon">
              <span class="avatar-title rounded-circle bg-info">
                <i class="ri-team-line font-size-24"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-xl-3 col-md-6">
      <div class="card mini-stats-wid">
        <div class="card-body">
          <div class="d-flex">
            <div class="flex-grow-1">
              <p class="text-muted fw-medium">Quality Score</p>
              <h4 class="mb-0">{{dashboardStats.averageQualityScore | number:'1.1-1'}}%</h4>
            </div>
            <div class="avatar-sm rounded-circle bg-warning align-self-center mini-stat-icon">
              <span class="avatar-title rounded-circle bg-warning">
                <i class="ri-star-line font-size-24"></i>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Quick Actions</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-4 col-sm-6" *ngFor="let action of quickActions">
              <div class="card border action-card" 
                   [class]="action.enabled ? 'shadow-sm' : 'bg-light'"
                   [class.enabled]="action.enabled"
                   [routerLink]="action.enabled ? action.route : null">
                <div class="card-body text-center">
                  <div class="avatar-sm mx-auto mb-4">
                    <span class="avatar-title rounded-circle" [class]="'bg-' + action.color">
                      <i [class]="action.icon + ' font-size-24'"></i>
                    </span>
                  </div>
                  <h5 class="font-size-15 mb-1">{{action.title}}</h5>
                  <p class="text-muted mb-0">{{action.description}}</p>
                  <span *ngIf="!action.enabled" class="badge badge-soft-secondary mt-2">Coming Soon</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity & Templates -->
  <div class="row">
    <!-- Recent Generation Activity -->
    <div class="col-xl-8">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Recent Document Generations</h4>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-nowrap mb-0">
              <thead class="table-light">
                <tr>
                  <th>Template</th>
                  <th>Generated At</th>
                  <th>Processing Time</th>
                  <th>Quality Score</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let log of recentGenerations">
                  <td>
                    <h6 class="mb-0">Template #{{log.templateId}}</h6>
                    <p class="text-muted font-size-13 mb-0">{{log.generationType}}</p>
                  </td>
                  <td>{{log.createdAt | date:'short'}}</td>
                  <td>{{log.processingTimeMs}}ms</td>
                  <td>
                    <span *ngIf="log.qualityScore" 
                          class="badge badge-soft-success">
                      {{log.qualityScore | number:'1.1-1'}}%
                    </span>
                    <span *ngIf="!log.qualityScore" class="text-muted">-</span>
                  </td>
                  <td>
                    <span class="badge" 
                          [class]="log.success ? 'badge-soft-success' : 'badge-soft-danger'">
                      {{log.success ? 'Success' : 'Failed'}}
                    </span>
                  </td>
                </tr>
                <tr *ngIf="recentGenerations.length === 0">
                  <td colspan="5" class="text-center text-muted py-4">
                    <i class="ri-file-text-line font-size-48 text-muted d-block mb-2"></i>
                    No recent document generations
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Popular Templates -->
    <div class="col-xl-4">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Popular Template Categories</h4>
        </div>
        <div class="card-body">
          <div *ngFor="let category of templateCategories.slice(0, 5)" class="d-flex align-items-center mb-3">
            <div class="avatar-xs me-3">
              <span class="avatar-title rounded-circle bg-primary-subtle text-primary">
                <i [class]="category.icon"></i>
              </span>
            </div>
            <div class="flex-grow-1">
              <h6 class="mb-0">{{category.name}}</h6>
              <p class="text-muted font-size-13 mb-0">{{category.templateCount}} templates</p>
            </div>
            <div>
              <button class="btn btn-outline-primary btn-sm" 
                      [routerLink]="['/legal/ai-assistant/templates', category.id]">
                View
              </button>
            </div>
          </div>
          
          <div *ngIf="templateCategories.length === 0" class="text-center text-muted py-4">
            <i class="ri-folder-line font-size-48 text-muted d-block mb-2"></i>
            No template categories available
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Active Collaboration Sessions -->
  <div class="row" *ngIf="activeSessions.length > 0">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Active Collaboration Sessions</h4>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6" *ngFor="let session of activeSessions">
              <div class="card border">
                <div class="card-body">
                  <div class="d-flex align-items-center mb-3">
                    <div class="avatar-sm me-3">
                      <span class="avatar-title rounded-circle bg-success">
                        <i class="ri-team-line"></i>
                      </span>
                    </div>
                    <div class="flex-grow-1">
                      <h6 class="mb-0">{{session.sessionName}}</h6>
                      <p class="text-muted font-size-13 mb-0">
                        {{session.participants.length}} participants
                      </p>
                    </div>
                    <div>
                      <button class="btn btn-primary btn-sm" 
                              (click)="joinSession(session.id)">
                        Join
                      </button>
                    </div>
                  </div>
                  
                  <div class="avatar-group">
                    <div class="avatar-group-item" *ngFor="let participant of session.participants.slice(0, 3)">
                      <a href="javascript: void(0);" class="d-inline-block">
                        <div class="avatar-xs">
                          <span class="avatar-title rounded-circle bg-primary-subtle text-primary">
                            {{participant.userName.charAt(0).toUpperCase()}}
                          </span>
                        </div>
                      </a>
                    </div>
                    <div class="avatar-group-item" *ngIf="session.participants.length > 3">
                      <a href="javascript: void(0);" class="d-inline-block">
                        <div class="avatar-xs">
                          <span class="avatar-title rounded-circle bg-light text-muted">
                            +{{session.participants.length - 3}}
                          </span>
                        </div>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>