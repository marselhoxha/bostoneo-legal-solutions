<!-- Secretary Dashboard -->
<div class="row">
  <!-- Dashboard Header -->
  <div class="col-12">
    <div class="page-title-box d-sm-flex align-items-center justify-content-between mb-4">
      <div>
        <h4 class="mb-sm-0">Secretary Dashboard - {{ departmentName }}</h4>
        <p class="text-muted mb-0">Welcome back, {{ currentUser?.firstName || 'Secretary' }}!</p>
      </div>
      <div class="page-title-right">
        <button class="btn btn-primary btn-sm" (click)="refreshDashboard()">
          <i class="ri-refresh-line me-1"></i> Refresh
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Dashboard Metrics -->
<div class="row">
  <!-- Department Cases -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-primary-subtle text-primary rounded-2 fs-2">
              <i class="ri-briefcase-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">Department Cases</p>
            <h4 class="mb-0">{{ departmentCases }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Today's Appointments -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-success-subtle text-success rounded-2 fs-2">
              <i class="ri-calendar-check-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">Today's Appointments</p>
            <h4 class="mb-0">{{ todayAppointments }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pending Documents -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-warning-subtle text-warning rounded-2 fs-2">
              <i class="ri-file-text-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">Pending Documents</p>
            <h4 class="mb-0">{{ pendingDocuments }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Upcoming Deadlines -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-danger-subtle text-danger rounded-2 fs-2">
              <i class="ri-alarm-warning-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">Upcoming Deadlines</p>
            <h4 class="mb-0">{{ upcomingDeadlines }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Client Communications -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-info-subtle text-info rounded-2 fs-2">
              <i class="ri-message-3-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">New Messages</p>
            <h4 class="mb-0">{{ clientCommunications }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Administrative Tasks -->
  <div class="col-xl-2 col-md-4 col-sm-6">
    <div class="card card-animate">
      <div class="card-body">
        <div class="d-flex align-items-center">
          <div class="avatar-sm flex-shrink-0">
            <span class="avatar-title bg-secondary-subtle text-secondary rounded-2 fs-2">
              <i class="ri-task-line"></i>
            </span>
          </div>
          <div class="flex-grow-1 ms-3">
            <p class="text-uppercase fw-medium text-muted mb-1">Tasks</p>
            <h4 class="mb-0">{{ administrativeTasks }}</h4>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Main Content Row -->
<div class="row">
  <!-- Today's Appointments -->
  <div class="col-xl-6">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1">Today's Appointments</h4>
        <button class="btn btn-sm btn-primary" (click)="scheduleAppointment()">
          <i class="ri-add-line me-1"></i> Schedule New
        </button>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-sm table-hover mb-0">
            <thead>
              <tr>
                <th>Time</th>
                <th>Client</th>
                <th>Attorney</th>
                <th>Type</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let appointment of todaysAppointments">
                <td>{{ appointment.time }}</td>
                <td>{{ appointment.client }}</td>
                <td>{{ appointment.attorney }}</td>
                <td>{{ appointment.type }}</td>
                <td>
                  <button class="btn btn-sm btn-link">
                    <i class="ri-eye-line"></i>
                  </button>
                </td>
              </tr>
              <tr *ngIf="todaysAppointments.length === 0">
                <td colspan="5" class="text-center text-muted">No appointments scheduled for today</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Attorney Schedules -->
  <div class="col-xl-6">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0">Attorney Availability</h4>
      </div>
      <div class="card-body">
        <div class="accordion" id="attorneySchedules">
          <div class="accordion-item" *ngFor="let attorney of attorneySchedules; let i = index">
            <h2 class="accordion-header">
              <button class="accordion-button" [class.collapsed]="i !== 0" type="button" 
                      data-bs-toggle="collapse" [attr.data-bs-target]="'#schedule' + i">
                <div class="d-flex align-items-center">
                  <div class="avatar-xs me-3">
                    <span class="avatar-title rounded-circle bg-primary">
                      {{ attorney.name.charAt(0) }}
                    </span>
                  </div>
                  <div>
                    <strong>{{ attorney.name }}</strong>
                    <small class="text-muted d-block">{{ attorney.title }}</small>
                  </div>
                </div>
              </button>
            </h2>
            <div [id]="'schedule' + i" class="accordion-collapse collapse" [class.show]="i === 0">
              <div class="accordion-body">
                <div class="table-responsive">
                  <table class="table table-sm mb-0">
                    <tbody>
                      <tr *ngFor="let slot of attorney.todaySchedule">
                        <td>{{ slot.time }}</td>
                        <td>{{ slot.event }}</td>
                        <td class="text-end">
                          <span [class]="getScheduleStatusClass(slot.status)">
                            <i class="ri-checkbox-blank-circle-fill me-1"></i>
                            {{ slot.status }}
                          </span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Secondary Row -->
<div class="row">
  <!-- Pending Documents -->
  <div class="col-xl-4">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1">Pending Documents</h4>
        <a href="javascript:void(0);" class="link-primary" (click)="navigateToDocuments()">View All</a>
      </div>
      <div class="card-body">
        <div class="list-group list-group-flush">
          <a *ngFor="let doc of pendingDocumentsList" class="list-group-item list-group-item-action">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <i class="ri-file-text-line text-primary fs-4"></i>
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1">{{ doc.name }}</h6>
                <small class="text-muted">{{ doc.case }} â€¢ Due: {{ doc.dueDate }}</small>
              </div>
              <div>
                <span class="badge bg-warning-subtle text-warning">{{ doc.status }}</span>
              </div>
            </div>
          </a>
          <div *ngIf="pendingDocumentsList.length === 0" class="text-center text-muted py-3">
            No pending documents
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Administrative Tasks -->
  <div class="col-xl-4">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1">Administrative Tasks</h4>
        <a href="javascript:void(0);" class="link-primary" (click)="navigateToTasks()">View All</a>
      </div>
      <div class="card-body">
        <div class="list-group list-group-flush">
          <div *ngFor="let task of upcomingTasks" class="list-group-item">
            <div class="d-flex align-items-center">
              <div class="form-check flex-shrink-0">
                <input class="form-check-input" type="checkbox" [id]="'task' + task.id">
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1">{{ task.title }}</h6>
                <small class="text-muted">Due: {{ task.dueDate }}</small>
              </div>
              <div>
                <i class="ri-flag-2-line" [class]="getTaskPriorityClass(task.priority)"></i>
              </div>
            </div>
          </div>
          <div *ngIf="upcomingTasks.length === 0" class="text-center text-muted py-3">
            No pending tasks
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Client Communications -->
  <div class="col-xl-4">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1">Recent Communications</h4>
        <a href="javascript:void(0);" class="link-primary" (click)="navigateToCommunications()">View All</a>
      </div>
      <div class="card-body">
        <div class="list-group list-group-flush">
          <a *ngFor="let comm of recentCommunications" class="list-group-item list-group-item-action">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <div class="avatar-xs">
                  <span class="avatar-title rounded-circle bg-primary-subtle text-primary">
                    {{ comm.from.charAt(0) }}
                  </span>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <h6 class="mb-1">
                  {{ comm.from }}
                  <span *ngIf="comm.unread" class="badge bg-danger ms-1">New</span>
                </h6>
                <p class="mb-0 text-muted small">{{ comm.subject }}</p>
              </div>
              <div>
                <small class="text-muted">{{ comm.time }}</small>
              </div>
            </div>
          </a>
          <div *ngIf="recentCommunications.length === 0" class="text-center text-muted py-3">
            No recent communications
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Department Cases -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header align-items-center d-flex">
        <h4 class="card-title mb-0 flex-grow-1">Department Cases</h4>
        <a href="javascript:void(0);" class="link-primary" (click)="navigateToCases()">View All</a>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead>
              <tr>
                <th>Case Number</th>
                <th>Title</th>
                <th>Status</th>
                <th>Next Deadline</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let case of recentCases">
                <td>
                  <a href="javascript:void(0);" (click)="viewCase(case.id)" class="fw-medium link-primary">
                    {{ case.caseNumber }}
                  </a>
                </td>
                <td>{{ case.title }}</td>
                <td>
                  <span [class]="getCaseStatusClass(case.status)">{{ case.status }}</span>
                </td>
                <td>{{ case.nextDeadline || 'No deadline set' }}</td>
                <td>
                  <div class="btn-group btn-group-sm">
                    <button class="btn btn-link text-primary" (click)="viewCase(case.id)">
                      <i class="ri-eye-line"></i>
                    </button>
                    <button class="btn btn-link text-muted">
                      <i class="ri-file-add-line"></i>
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="recentCases.length === 0">
                <td colspan="5" class="text-center text-muted">No cases found</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>